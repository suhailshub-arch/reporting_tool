{% extends "base.html" %}

{% block content %}

<section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <h1>Finding Details</h1>
        </div>
      </div>
    </div>
  </section>

  <section class="content">
    <div class="container-fluid">


      <div class="row">
        <div class="col-md-12">

            <div class="card card-outline card-danger">
                <div class="card-header">
                  <h3 class="card-title">
                    <i class="far fa-chart-bar"></i>
                    <b>Summary</b>
                  </h3>
                  <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                      <i class="fas fa-minus"></i>
                    </button>
                  </div>

                </div>

                <div class="card-body">
                    
      
                    <div class="row mb-3">
                        <div class="col-12 col-sm-4">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">Finding ID</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.finding_id }}</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-4">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block"> Status</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.status }}</span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-4">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block"> Date</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.creation_date | date:"d-m-Y H:m:s" }}</span>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div class="row mb-3">
                        <div class="col-12 col-sm-6">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">Customer</span>
                              <span class="info-box-text text-center text-muted d-block">
                                <a href="{% url 'customer_view' finding.report.customer.id %}">{{ finding.report.customer.name }}</a>
                              </span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-6">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">Report</span>
                              <span class="info-box-text text-center text-muted d-block">
                                <a href="{% url 'report_view' finding.report.id %}">{{ finding.report.title }}</a>
                              </span>
                            </div>
                          </div>
                        </div>
                    </div>

                      <div class="row mb-3">
                        <div class="col-12 col-sm-6">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CWE</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.cwe.cwe_id }} - {{finding.cwe.cwe_name }}</span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-6">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">OWASP</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.owasp.owasp_id }} - {{finding.owasp.owasp_name }}</span>
                            </div>
                          </div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-12 col-sm-6">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CVSS Vector</span>
                              <span class="info-box-text text-center text-muted d-block">PlaceHolder</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-3">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CVSS Score</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.cvss_score }}</span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-3">
                          <div class="info-box bg-light">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">Severity</span>
                              <span class="info-box-text text-center text-muted d-block">
                                {% if finding.severity == "Critical" %}
                                    <b><font color="#CC0000">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "High" %}
                                    <b><font color="#F20000">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Medium" %}
                                    <b><font color="#FC7F03">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Low" %}
                                    <b><font color="#05B04F">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Info" %}
                                    <b><font color="#45A7F7">{{ finding.severity }}</font></b>
                                {% else %}
                                    <b>{{ finding.severity }}</b>
                                {% endif %}
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>
                    
                </div>
              </div>

        </div>
      </div> 

        <div class="row mb-6">
          <div class="col-md-12">
  
              <div class="card card-outline card-danger">
                  <div class="card-header">
                    <h3 class="card-title">
                      <i class="far fa-chart-bar"></i>
                      <b>Title</b>
                    </h3>
                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
  
                  </div>
  
                  <div class="card-body">
                      
                    {{ finding.title }}
                      
                  </div>
                </div>
                

                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Description</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body">
                                
                              {{ finding.description | safe }}
                                
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Location</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body">
                                
                              {{ finding.location | safe }}
                                
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Impact</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body">
                                
                              {{ finding.impact | safe }}
                                
                            </div>
                        </div>
                    </div>
                </div>


                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Recommendation</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body">
                                
                              {{ finding.recommendation | safe }}
                                
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>References</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body">
                                
                              {{ finding.references | safe }}
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
</div>


    </section>
{% endblock %}


