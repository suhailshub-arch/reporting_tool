{% extends "base.html" %}
{% load static %}
{% load martortags %}

{% block stylesheets %}
  {{ block.super }}
  
  <!-- <style>
    .info-box{
      filter: brightness(80%);
    }
  </style> -->

{% endblock stylesheets %}

{% block content %}

<section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6 speakable">
          <h1>Template Finding Details</h1>
        </div>
      </div>
    </div>
  </section>

  <section class="content">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-12">
            <div class="card card-outline card-danger">
                <div class="card-header speakable">
                  <h3 class="card-title">
                    <i class="far fa-chart-bar"></i>
                    <b>Summary</b>
                  </h3>
                  <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                      <i class="fas fa-minus"></i>
                    </button>
                  </div>

                </div>

                <div class="card-body">

                      <div class="row mb-3">
                        <div class="col-12 col-sm-6">
                          <div class="info-box speakable">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CWE</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.cwe.cwe_id }} - {{finding.cwe.cwe_name }}</span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-6">
                          <div class="info-box speakable">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">OWASP</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.owasp.owasp_id }} - {{finding.owasp.owasp_name }}</span>
                            </div>
                          </div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-12 col-sm-6">
                          <div class="info-box speakable">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CVSS Vector</span>
                              <span class="info-box-text text-center text-muted d-block">PlaceHolder</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-12 col-sm-3">
                          <div class="info-box speakable">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">CVSS Score</span>
                              <span class="info-box-text text-center text-muted d-block">{{ finding.cvss_score }}</span>
                            </div>
                          </div>
                        </div>
  
                        <div class="col-12 col-sm-3">
                          <div class="info-box speakable">
                            <div class="info-box-content">
                              <span class="info-box-number text-center text-muted mb-2 d-block">Severity</span>
                              <span class="info-box-text text-center text-muted d-block">
                                {% if finding.severity == "Critical" %}
                                    <b><font color="#CC0000">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "High" %}
                                    <b><font color="#F20000">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Medium" %}
                                    <b><font color="#FC7F03">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Low" %}
                                    <b><font color="#05B04F">{{ finding.severity }}</font></b>
                                {% elif finding.severity == "Info" %}
                                    <b><font color="#45A7F7">{{ finding.severity }}</font></b>
                                {% else %}
                                    <b>{{ finding.severity }}</b>
                                {% endif %}
                              </span>
                            </div>
                          </div>
                        </div>
                      </div>
                    
                </div>
              </div>

        </div>
      </div> 

        <div class="row mb-6">
          <div class="col-md-12">
  
              <div class="card card-outline card-danger">
                  <div class="card-header speakable">
                    <h3 class="card-title">
                      <i class="far fa-chart-bar"></i>
                      <b>Title</b>
                    </h3>
                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                        <i class="fas fa-minus"></i>
                      </button>
                    </div>
  
                  </div>
  
                  <div class="card-body speakable">
                      
                    {{ finding.title | safe_markdown }}
                      
                  </div>
                </div>
                

                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header speakable">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Description</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body speakable">
                                
                              {{ finding.description | safe_markdown }}
                                
                            </div>
                        </div>
                    </div>
                </div>
                

                <!-- <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header speakable">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Impact</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body speakable">
                                
                              {{ finding.impact | safe_markdown }}
                                
                            </div>
                        </div>
                    </div>
                </div> -->


                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header speakable">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>Recommendation</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body speakable">
                                
                              {{ finding.recommendation | safe_markdown }}
                                
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row mb-6">
                    <div class="col-md-12">
            
                        <div class="card card-outline card-danger">
                            <div class="card-header speakable">
                              <h3 class="card-title">
                                <i class="far fa-chart-bar"></i>
                                <b>References</b>
                              </h3>
                              <div class="card-tools">
                                <button type="button" class="btn btn-tool" data-card-widget="collapse" title="Collapse">
                                  <i class="fas fa-minus"></i>
                                </button>
                              </div>
            
                            </div>
            
                            <div class="card-body speakable">
                                
                              {{ finding.references | safe_markdown }}
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            
</div>


    </section>
{% endblock %}


